

---
title: "臨床試験のサンプルサイズ設計"
date: "2025-05-17"
author: "坂本航太"
categories: [統計学, 臨床試験]
---

# 実務で利用するサンプルサイズ設計

本書は、ARO（Academi Research Organization）
の実務で利用するサンプルサイズ設計について解説します。特に、SASを用いたサンプルサイズ設計の方法に焦点を当てています。実務で利用することのみを念頭に置いているため、数理的な導出は省きます。
本書では、以下の内容を扱SSいます。

# 目次
- 0章：はじめに
  - 比較の形式
    - 優越性を示すための試験
    - 同等性又は非劣性を示すための試験
    - 用量反応関係を示すための試験
- 1章：単群試験
  - 2値アウトカム
- 並行群間比較計画
  - 2値アウトカム
  - 連続量アウトカム
  - 生存時間アウトカム
- 群逐次計画
  - 無効中止
  - 有効中止
  - 無効中止と有効中止の両方を考慮する場合
- クロスオーバ―計画
-  シミュレーションに基づくサンプルサイズ設計

# 単群試験

## 2値アウトカム

2値アウトカムの場合、サンプルサイズは以下の式で計算できます。例えば、1標本割合の検定です。主に抗がん剤の第2相試験を想定しています。

- H0: p = 0.1（閾値奏効割合）
- H1: p > 0.3（期待奏効率）
- α = 0.05（第一種の過誤、片側）
- β = 0.2（第二種の過誤）

実務上では、無効中止や有効中止を考慮する必要がある場合もあり、後述するSimonの2段階デザインやFlemingの2段階デザインを用いることが多いです。

以下は、正規近似を用いたサンプルサイズ計算の例です。
連続修正は行いません。正規近似に基づく症例数設計では、H0におけるp0を用いて分散が計算されている点は理解されたい。
```sas
proc power;
onesamplefreq test=z
    method = normal
    sides = 1
    alpha = 0.05
    nullproportion = 0.1
    proportion = 0.3
    ntotal = .
    power = 0.8;
run;
```

しかし、実務では2項分布による正確な検定に基づく症例数設計を利用することが標準です。理由は正規近似による例数設計が二項分布の中心極限定理を用いているため、あくまでＮ→∞における漸近論を仮定しているためです。漸近論を利用せず、2項分布を用いて症例数設計をするSASプログラムは以下となる。

```sas
proc power;
    onesamplefreq test=exact
        sides = 1
        alpha = 0.05
        nullproportion = 0.1
        proportion = 0.3
        ntotal = 30.
        power = .;
        plot x = n min =2 max = 100 step = 1 yopts = (ref  = 0.8);
run;
```
上記のプログラムを実行すると、必要症例数に対して検出力は単調増加になりません。Nは目標とするPowerの値を満たす最小の整数値 or 目標とするPowerの値を満たす最大の整数値とします。個人的には、より保守的だえうため後者を推奨します。。実際、より大きなサンプルサイズを選ぶことで、検出力の目標値をより確実に達成できる可能性が高まります。ただし、リソースの制約がある場合は、目標検出力を満たす最小のn値を選ぶことも実用的な選択肢となり得ます。どちらのアプローチを取るかは、研究の目的やリソースの制約によって相談の上、決定してください。






# 並行群間比較計画

## 連続量アウトカム
連続量アウトカムの場合、サンプルサイズは以下の式で計算できます。
以下では優越性を示す第3相試験のような検証的試験を想定しています。

```sas
proc power;
    twosamplemeans test=diff
        meandiff = 0.5
        stddev = 1
        alpha = 0.05
        power = 0.8
        nptotal = .;
run;
```

複数の状況をまとめて計算する場合は、以下のようにします。

```sas
proc power;
    twosamplemeans test=diff
        meandiff = 0.5 , 1 , 1.5
        stddev = 1 , 2 , 3
        alpha = 0.05
        power = 0.8
        ntotal = .;
run;
```

## 2値アウトカム

2値アウトカムの場合、サンプルサイズは以下の式で計算できます。例えば、2標本割合の検定です。基本的に、リスク差（割合の差）に基づいて優越性を検討することを想定しています。一般的に、2値アウトカムを主要評価項目として第3相試験を計画することは多くないような気がします。

- H0: p1 - p2 = 0（閾値奏効割合）
- H1: p1 - p2 > 0（期待奏効率）
- α = 0.05（第一種の過誤、両側）
- β = 0.2（第二種の過誤）


SASプログラムは以下となる。ここでは、対照群のp1及びリスク差を指定している。リスク差は、対照群のp0に基づいて計算されるため、対照群のp0を指定する必要がある。

```sas
proc power;
twossamplefreq test=pchi
    sides = 2
    alpha = 0.05
    refproportion = 0.1
    proportiondiff = 0.2
    npergroup = .
    power = 0.8;
run;
```